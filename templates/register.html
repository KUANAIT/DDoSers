<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - SSE</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<header class="bg-primary text-white text-center py-3">
    <h1>Register for SSE</h1>
</header>

<main class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <form id="registerForm">
                <div class="mb-3">
                    <label for="iin" class="form-label">IIN</label>
                    <input type="text" class="form-control" id="iin" name="iin" required>
                </div>

                <div class="mb-3">
                    <label for="identityCard" class="form-label">Identity Card Number</label>
                    <input type="text" class="form-control" id="identityCard" name="identity_card" required>
                </div>

                <div class="mb-3">
                    <label for="firstName" class="form-label">First Name</label>
                    <input type="text" class="form-control" id="firstName" name="first_name" required>
                </div>

                <div class="mb-3">
                    <label for="lastName" class="form-label">Last Name</label>
                    <input type="text" class="form-control" id="lastName" name="last_name" required>
                </div>

                <div class="mb-3">
                    <label for="birthday" class="form-label">Birthday</label>
                    <input type="date" class="form-control" id="birthday" name="birthday" required>
                </div>

                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" class="form-control" id="password" name="password" required>
                </div>

                <div class="mb-3">
                    <label for="address" class="form-label">Address</label>
                    <input type="text" class="form-control" id="address" name="address" placeholder="Full address" required>
                </div>

                <button type="submit" class="btn btn-primary w-100">Register</button>
            </form>
            <div id="error-message" class="mt-3 text-danger"></div>
        </div>
    </div>
</main>

<footer class="bg-dark text-white text-center py-3">
    <p>&copy; 2025 DDoSers. All Rights Reserved.</p>
</footer>

<script>
    document.getElementById('registerForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const iin = document.getElementById('iin').value;
        const identityCard = document.getElementById('identityCard').value;
        const firstName = document.getElementById('firstName').value;
        const lastName = document.getElementById('lastName').value;
        const birthday = document.getElementById('birthday').value;
        const password = document.getElementById('password').value;
        const address = document.getElementById('address').value;

        if (!iin || !identityCard || !firstName || !lastName || !birthday || !password || !address) {
            document.getElementById('error-message').textContent = 'All fields are required';
            return;
        }

        const userData = {
            iin: iin,
            identity_card: identityCard,
            first_name: firstName,
            last_name: lastName,
            birthday: birthday,
            password: password,
            address: address
        };

        console.log('Sending data:', userData);

        try {
            const response = await fetch('/users', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(userData)
            });

            const result = await response.json();
            console.log('Response:', response.status, result);

            if (response.ok) {
                window.location.href = '/login';
            } else {
                document.getElementById('error-message').textContent = result.message || 'An error occurred during registration';
            }
        } catch (error) {
            console.error('Error:', error);
            document.getElementById('error-message').textContent = 'Network error, please try again later';
        }
    });
</script>

</body>
</html>
